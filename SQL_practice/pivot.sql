CREATE TABLE MENU_LOG (
    MENU_LOG_NO NUMBER(30) PRIMARY KEY,
    MENU_NO NUMBER(10) NOT NULL,
    USER_NO NUMBER(15),
    MENU_LOG_IP VARCHAR2(100),
    MENU_LOG_TIME TIMESTAMP
);
CREATE SEQUENCE MENU_LOG_SEQ;
INSERT INTO MENU_LOG (MENU_LOG_NO, MENU_NO, USER_NO, MENU_LOG_IP, MENU_LOG_TIME)
VALUES (MENU_LOG_SEQ.NEXTVAL, 1, 1, '192.100.100.1', SYSTIMESTAMP);
INSERT INTO MENU_LOG (MENU_LOG_NO, MENU_NO, USER_NO, MENU_LOG_IP, MENU_LOG_TIME)
VALUES (MENU_LOG_SEQ.NEXTVAL, 1, 1, '192.100.100.1', '2021-11-10 00:00:00');
INSERT INTO MENU_LOG (MENU_LOG_NO, MENU_NO, USER_NO, MENU_LOG_IP, MENU_LOG_TIME)
VALUES (MENU_LOG_SEQ.NEXTVAL, 1, 1, '192.100.100.1', '2020-11-09 00:00:00');
INSERT INTO MENU_LOG (MENU_LOG_NO, MENU_NO, USER_NO, MENU_LOG_IP, MENU_LOG_TIME)
VALUES (MENU_LOG_SEQ.NEXTVAL, 1, 1, '192.100.100.1', '2020-10-10 00:00:30');
INSERT INTO MENU_LOG (MENU_LOG_NO, MENU_NO, USER_NO, MENU_LOG_IP, MENU_LOG_TIME)
VALUES (MENU_LOG_SEQ.NEXTVAL, 2, 1, '192.100.100.1', SYSTIMESTAMP);
INSERT INTO MENU_LOG (MENU_LOG_NO, MENU_NO, USER_NO, MENU_LOG_IP, MENU_LOG_TIME)
VALUES (MENU_LOG_SEQ.NEXTVAL, 2, 1, '192.100.100.1', '2021-12-13 00:00:10');
INSERT INTO MENU_LOG (MENU_LOG_NO, MENU_NO, USER_NO, MENU_LOG_IP, MENU_LOG_TIME)
VALUES (MENU_LOG_SEQ.NEXTVAL, 2, 1, '192.100.100.1', '2021-12-14 10:00:12');
INSERT INTO MENU_LOG (MENU_LOG_NO, MENU_NO, USER_NO, MENU_LOG_IP, MENU_LOG_TIME)
VALUES (MENU_LOG_SEQ.NEXTVAL, 2, 1, '192.100.100.1', '2020-01-01 10:28:12');
INSERT INTO MENU_LOG (MENU_LOG_NO, MENU_NO, USER_NO, MENU_LOG_IP, MENU_LOG_TIME)
VALUES (MENU_LOG_SEQ.NEXTVAL, 3, 1, '192.100.100.1', SYSTIMESTAMP);
INSERT INTO MENU_LOG (MENU_LOG_NO, MENU_NO, USER_NO, MENU_LOG_IP, MENU_LOG_TIME)
VALUES (MENU_LOG_SEQ.NEXTVAL, 3, 1, '192.100.100.1', '2022-09-01 12:13:12');
INSERT INTO MENU_LOG (MENU_LOG_NO, MENU_NO, USER_NO, MENU_LOG_IP, MENU_LOG_TIME)
VALUES (MENU_LOG_SEQ.NEXTVAL, 3, 1, '192.100.100.1', '2020-10-11 08:00:14');
SELECT * FROM MENU_LOG;

SELECT to_char(SYSTIMESTAMP - INTERVAL '1' YEAR, 'yyyy') FROM DUAL;

SELECT * FROM
(SELECT MENU_NO, TO_CHAR(MENU_LOG_TIME, 'YYYY')||'년' MENU_LOG_YEAR
FROM MENU_LOG)
PIVOT (
    COUNT(*)
    FOR MENU_LOG_YEAR IN ('2020년', '2021년', '2022년')
);

SELECT MENU_NO
    ,  SUM(DECODE(TO_CHAR(MENU_LOG_TIME, 'FMMM'), '1', 1, 0)) "1월"
    ,  SUM(DECODE(TO_CHAR(MENU_LOG_TIME, 'FMMM'), '2', 1, 0)) "2월"
    ,  SUM(DECODE(TO_CHAR(MENU_LOG_TIME, 'FMMM'), '3', 1, 0)) "3월"
    ,  SUM(DECODE(TO_CHAR(MENU_LOG_TIME, 'FMMM'), '4', 1, 0)) "4월"
    ,  SUM(DECODE(TO_CHAR(MENU_LOG_TIME, 'FMMM'), '5', 1, 0)) "5월"
    ,  SUM(DECODE(TO_CHAR(MENU_LOG_TIME, 'FMMM'), '6', 1, 0)) "6월"
    ,  SUM(DECODE(TO_CHAR(MENU_LOG_TIME, 'FMMM'), '7', 1, 0)) "7월"
    ,  SUM(DECODE(TO_CHAR(MENU_LOG_TIME, 'FMMM'), '8', 1, 0)) "8월"
    ,  SUM(DECODE(TO_CHAR(MENU_LOG_TIME, 'FMMM'), '9', 1, 0)) "9월"
    ,  SUM(DECODE(TO_CHAR(MENU_LOG_TIME, 'FMMM'), '10', 1, 0)) "10월"
    ,  SUM(DECODE(TO_CHAR(MENU_LOG_TIME, 'FMMM'), '11', 1, 0)) "11월"
    ,  SUM(DECODE(TO_CHAR(MENU_LOG_TIME, 'FMMM'), '12', 1, 0)) "12월"
FROM MENU_LOG
GROUP BY MENU_NO;

COMMIT;